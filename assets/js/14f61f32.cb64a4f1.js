"use strict";(self.webpackChunkreact_native_testing_library_website=self.webpackChunkreact_native_testing_library_website||[]).push([[456],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||a;return n?i.createElement(h,o(o({ref:t},p),{},{components:n})):i.createElement(h,o({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<a;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2087:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return s},default:function(){return h},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return u}});var i=n(7462),r=n(3366),a=(n(7294),n(3905)),o=["components"],l={id:"migration-v12",title:"Migration to 12.0"},s=void 0,c={unversionedId:"migration-v12",id:"migration-v12",title:"Migration to 12.0",description:"React Native Testing Library 12 introduces a handful of breaking changes compared to 11.x versions. We believe they were necessary to improve the experience using the library and help the users fall into the pit of success when writing meaningful tests. You will find migration instructions for each and every change described below.",source:"@site/docs/MigrationV12.md",sourceDirName:".",slug:"/migration-v12",permalink:"/react-native-testing-library/docs/migration-v12",draft:!1,editUrl:"https://github.com/callstack/react-native-testing-library/blob/main/docs/MigrationV12.md",tags:[],version:"current",frontMatter:{id:"migration-v12",title:"Migration to 12.0"},sidebar:"docs",previous:{title:"Understanding Act function",permalink:"/react-native-testing-library/docs/understanding-act"},next:{title:"Migration to 11.0",permalink:"/react-native-testing-library/docs/migration-v11"}},p={},u=[{value:"1. All queries exclude elements hidden from accessibility by default",id:"1-all-queries-exclude-elements-hidden-from-accessibility-by-default",level:2},{value:"2. <code>*ByRole</code> queries now return only accessibility elements",id:"2-byrole-queries-now-return-only-accessibility-elements",level:2},{value:"Examples",id:"examples",level:3},{value:"3. <code>*ByText</code>, <code>*ByDisplayValue</code>, <code>*ByPlaceholderText</code> queries now return host elements",id:"3-bytext-bydisplayvalue-byplaceholdertext-queries-now-return-host-elements",level:2},{value:"4. <code>container</code> API has been renamed to <code>UNSAFE_root</code>.",id:"4-container-api-has-been-renamed-to-unsafe_root",level:2}],d={toc:u},m="wrapper";function h(e){var t=e.components,n=(0,r.Z)(e,o);return(0,a.kt)(m,(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"React Native Testing Library 12 introduces a handful of breaking changes compared to 11.x versions. We believe they were necessary to improve the experience using the library and help the users ",(0,a.kt)("a",{parentName:"p",href:"https://blog.codinghorror.com/falling-into-the-pit-of-success/"},"fall into the pit of success")," when writing meaningful tests. You will find migration instructions for each and every change described below."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"If you use ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/testing-library/jest-native"},"Jest Native matchers"),", which we recommend, then you should upgrade it to version 5.4.2 or higher.")),(0,a.kt)("h1",{id:"breaking-changes"},"Breaking changes"),(0,a.kt)("h2",{id:"1-all-queries-exclude-elements-hidden-from-accessibility-by-default"},"1. All queries exclude elements hidden from accessibility by default"),(0,a.kt)("p",null,"Elements that are hidden from accessiblity, e.g. elements on non-active screen when using React Navigation, now will not be matched by default by all queries. This is the effect of switching the default value for global config option ",(0,a.kt)("inlineCode",{parentName:"p"},"defaultIncludeHiddenElements"),"(api#defaultincludehiddenelements-option) to ",(0,a.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,a.kt)("p",null,"Previous behaviour of matching hidden elements can be enabled on query level using ",(0,a.kt)("a",{parentName:"p",href:"api-queries#includehiddenelements-option"},"includeHiddenElements")," query options or globally using ",(0,a.kt)("inlineCode",{parentName:"p"},"defaultIncludeHiddenElements"),"(api#defaultincludehiddenelements-option) configuration option."),(0,a.kt)("h2",{id:"2-byrole-queries-now-return-only-accessibility-elements"},"2. ",(0,a.kt)("inlineCode",{parentName:"h2"},"*ByRole")," queries now return only accessibility elements"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"*ByRole")," queries now return only accessibility elements, either explicitly marked with ",(0,a.kt)("inlineCode",{parentName:"p"},"accessible")," prop or implicit ones where this status is derived from component type itself (e.g ",(0,a.kt)("inlineCode",{parentName:"p"},"Text"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"TextInput"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"Switch"),", but not ",(0,a.kt)("inlineCode",{parentName:"p"},"View"),")."),(0,a.kt)("p",null,"You may need to adjust relevant components under test to make sure they pass ",(0,a.kt)("inlineCode",{parentName:"p"},"isAccessibilityElement")," check."),(0,a.kt)("h3",{id:"examples"},"Examples"),(0,a.kt)("p",null,"Let's assume we are using ",(0,a.kt)("inlineCode",{parentName:"p"},'getByRole("button")')," query."),(0,a.kt)("p",null,"Following elements will match:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'// Explicit "accessible" prop for View\n<View accessible role="button" />\n\n// No need to "accessible" prop for Text, as it is implicitly accessible element.\n<Text role="button">Button</Text>\n')),(0,a.kt)("p",null,"While following elements will not match:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'// Missing "accessible" prop for View\n<View role="button" />\n\n// Explicit "accessible={false}" prop for View\n<View accessible={false} role="button" />\n\n// Explicit "accessible={false}" for Text, which is implicitly accessible element\n<Text accessible={false} role="button">Button</Text>\n')),(0,a.kt)("h2",{id:"3-bytext-bydisplayvalue-byplaceholdertext-queries-now-return-host-elements"},"3. ",(0,a.kt)("inlineCode",{parentName:"h2"},"*ByText"),", ",(0,a.kt)("inlineCode",{parentName:"h2"},"*ByDisplayValue"),", ",(0,a.kt)("inlineCode",{parentName:"h2"},"*ByPlaceholderText")," queries now return host elements"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"*ByText"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"*ByDisplayValue"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"*ByPlaceholderText")," queries now return ",(0,a.kt)("a",{parentName:"p",href:"testing-env#host-and-composite-components"},"host elements"),", which is consistent with other queries."),(0,a.kt)("p",null,"While potentially breaking, this should not cause issues in tests if you are using recommended queries and Jest Matchers from Jest Native package. "),(0,a.kt)("p",null,"Problematic cases may include: directly checking some prop values (without using Jest Native matchers), referencing other nodes using ",(0,a.kt)("inlineCode",{parentName:"p"},"parent")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"children")," props, examining ",(0,a.kt)("inlineCode",{parentName:"p"},"type")," property of ",(0,a.kt)("inlineCode",{parentName:"p"},"ReactTestInstance"),", etc."),(0,a.kt)("h2",{id:"4-container-api-has-been-renamed-to-unsafe_root"},"4. ",(0,a.kt)("inlineCode",{parentName:"h2"},"container")," API has been renamed to ",(0,a.kt)("inlineCode",{parentName:"h2"},"UNSAFE_root"),"."),(0,a.kt)("p",null,"Historically ",(0,a.kt)("inlineCode",{parentName:"p"},"container")," was supposed to mimic the ",(0,a.kt)("a",{parentName:"p",href:"https://testing-library.com/docs/react-testing-library/api/#container"},"RTL's container"),". However it turned out not so relevant in RNTL's environment, where we actually used it to return React Test Renderer's root instance."),(0,a.kt)("p",null,"RNTL v12 introduces ",(0,a.kt)("inlineCode",{parentName:"p"},"root")," API as an alternative that returns a root ",(0,a.kt)("strong",{parentName:"p"},"host")," element. The difference between ",(0,a.kt)("inlineCode",{parentName:"p"},"root")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"UNSAFE_root")," properties is that that ",(0,a.kt)("inlineCode",{parentName:"p"},"root")," will always represents a host element, while ",(0,a.kt)("inlineCode",{parentName:"p"},"UNSAFE_root")," will typically represent a composite element."),(0,a.kt)("p",null,"If you use ",(0,a.kt)("inlineCode",{parentName:"p"},"toBeOnTheScreen")," matcher from ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/testing-library/jest-native"},"@testing-library/jest-native")," your tests will fail because it uses the ",(0,a.kt)("inlineCode",{parentName:"p"},"container")," api. To fix this, update ",(0,a.kt)("inlineCode",{parentName:"p"},"@testing-library/jest-native")," to version 5.4.2.    "),(0,a.kt)("h1",{id:"full-changelog"},"Full Changelog"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/callstack/react-native-testing-library/compare/v11.5.2...v11.5.2...v12.0.0-rc.0"},"https://github.com/callstack/react-native-testing-library/compare/v11.5.2...v11.5.2...v12.0.0-rc.0")))}h.isMDXComponent=!0}}]);