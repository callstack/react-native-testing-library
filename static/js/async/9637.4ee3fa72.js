"use strict";(self.rspackChunkwebsite=self.rspackChunkwebsite||[]).push([["9637"],{8900(e,s,n){n.r(s),n.d(s,{default:()=>o});var i=n(4848),r=n(8453),t=n(7425);function l(e){let s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",span:"span",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.h1,{id:"migration-to-12x",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#migration-to-12x",children:"#"}),"Migration to 12.x"]}),"\n",(0,i.jsx)(t.Pq,{type:"info",title:"Info",children:(0,i.jsxs)(s.p,{children:["If you are already using legacy ",(0,i.jsx)(s.code,{children:"@testing-library/jest-native"})," Jest Matchers, we have a ",(0,i.jsx)(s.a,{href:"/docs/migration/jest-matchers.html",children:"migration guide"})," for moving to the built-in matchers."]})}),"\n",(0,i.jsxs)(s.p,{children:["React Native Testing Library 12 introduces a handful of breaking changes compared to 11.x versions. We believe they were necessary to improve the experience using the library and help the users ",(0,i.jsx)(s.a,{href:"https://blog.codinghorror.com/falling-into-the-pit-of-success/",rel:"noopener noreferrer",target:"_blank",children:"fall into the pit of success"})," when writing meaningful tests. You will find migration instructions for each and every change described below."]}),"\n",(0,i.jsxs)(s.h2,{id:"breaking-changes",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#breaking-changes",children:"#"}),"Breaking changes"]}),"\n",(0,i.jsxs)(s.h3,{id:"1-all-queries-exclude-elements-hidden-from-accessibility-by-default",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#1-all-queries-exclude-elements-hidden-from-accessibility-by-default",children:"#"}),"1. All queries exclude elements hidden from accessibility by default"]}),"\n",(0,i.jsxs)(s.p,{children:["Elements that are hidden from accessiblity, e.g. elements on non-active screen when using React Navigation, now will not be matched by default by all queries. This is the effect of switching the default value for global config option ",(0,i.jsx)(s.code,{children:"defaultIncludeHiddenElements"}),"(api#defaultincludehiddenelements-option) to ",(0,i.jsx)(s.code,{children:"false"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["Previous behaviour of matching hidden elements can be enabled on query level using ",(0,i.jsx)(s.a,{href:"/docs/api/queries.html#includehiddenelements-option",children:"includeHiddenElements"})," query options or globally using ",(0,i.jsx)(s.code,{children:"defaultIncludeHiddenElements"}),"(api#defaultincludehiddenelements-option) configuration option."]}),"\n",(0,i.jsxs)(s.h3,{id:"2-byrole-queries-now-return-only-accessibility-elements",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#2-byrole-queries-now-return-only-accessibility-elements",children:"#"}),"2. ",(0,i.jsx)(s.code,{children:"*ByRole"})," queries now return only accessibility elements"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"*ByRole"})," queries now return only accessibility elements, either explicitly marked with ",(0,i.jsx)(s.code,{children:"accessible"})," prop or implicit ones where this status is derived from component type itself (e.g ",(0,i.jsx)(s.code,{children:"Text"}),", ",(0,i.jsx)(s.code,{children:"TextInput"}),", ",(0,i.jsx)(s.code,{children:"Switch"}),", but not ",(0,i.jsx)(s.code,{children:"View"}),")."]}),"\n",(0,i.jsxs)(s.p,{children:["You may need to adjust relevant components under test to make sure they pass ",(0,i.jsx)(s.code,{children:"isAccessibilityElement"})," check."]}),"\n",(0,i.jsxs)(s.h4,{id:"examples",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#examples",children:"#"}),"Examples"]}),"\n",(0,i.jsxs)(s.p,{children:["Let's assume we are using ",(0,i.jsx)(s.code,{children:'getByRole("button")'})," query."]}),"\n",(0,i.jsx)(s.p,{children:"Following elements will match:"}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"tsx",children:(0,i.jsxs)(s.code,{children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:'// Explicit "accessible" prop for View'})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"View"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" accessible"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" accessibilityRole"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"button"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,i.jsx)(s.span,{className:"line"}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:'// No need to "accessible" prop for Text, as it is implicitly accessible element.'})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Text"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" accessibilityRole"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"button"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">Button</"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Text"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]})]})})}),"\n",(0,i.jsx)(s.p,{children:"While following elements will not match:"}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"tsx",children:(0,i.jsxs)(s.code,{children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:'// Missing "accessible" prop for View'})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"View"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" accessibilityRole"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"button"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,i.jsx)(s.span,{className:"line"}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:'// Explicit "accessible={false}" prop for View'})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"View"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" accessible"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"false"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"accessibilityRole"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"button"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,i.jsx)(s.span,{className:"line"}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:'// Explicit "accessible={false}" for Text, which is implicitly accessible element'})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Text"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" accessible"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"false"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"accessibilityRole"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"button"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">Button</"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Text"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]})]})})}),"\n",(0,i.jsxs)(s.h3,{id:"3-bytext-bydisplayvalue-byplaceholdertext-queries-now-return-host-elements",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#3-bytext-bydisplayvalue-byplaceholdertext-queries-now-return-host-elements",children:"#"}),"3. ",(0,i.jsx)(s.code,{children:"*ByText"}),", ",(0,i.jsx)(s.code,{children:"*ByDisplayValue"}),", ",(0,i.jsx)(s.code,{children:"*ByPlaceholderText"})," queries now return host elements"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"*ByText"}),", ",(0,i.jsx)(s.code,{children:"*ByDisplayValue"}),", ",(0,i.jsx)(s.code,{children:"*ByPlaceholderText"})," queries now return ",(0,i.jsx)(s.a,{href:"/docs/advanced/testing-env.html#host-and-composite-components",children:"host elements"}),", which is consistent with other queries."]}),"\n",(0,i.jsx)(s.p,{children:"While potentially breaking, this should not cause issues in tests if you are using recommended queries and Jest Matchers from Jest Native package."}),"\n",(0,i.jsxs)(s.p,{children:["Problematic cases may include: directly checking some prop values (without using Jest Native matchers), referencing other nodes using ",(0,i.jsx)(s.code,{children:"parent"})," or ",(0,i.jsx)(s.code,{children:"children"})," props, examining ",(0,i.jsx)(s.code,{children:"type"})," property of ",(0,i.jsx)(s.code,{children:"ReactTestInstance"}),", etc."]}),"\n",(0,i.jsxs)(s.h3,{id:"4-container-api-has-been-renamed-to-unsafe_root",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#4-container-api-has-been-renamed-to-unsafe_root",children:"#"}),"4. ",(0,i.jsx)(s.code,{children:"container"})," API has been renamed to ",(0,i.jsx)(s.code,{children:"UNSAFE_root"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["Historically ",(0,i.jsx)(s.code,{children:"container"})," was supposed to mimic the ",(0,i.jsx)(s.a,{href:"https://testing-library.com/docs/react-testing-library/screen#container",rel:"noopener noreferrer",target:"_blank",children:"RTL's container"}),". However it turned out not so relevant in RNTL's environment, where we actually used it to return React Test Renderer's root instance."]}),"\n",(0,i.jsxs)(s.p,{children:["RNTL v12 introduces ",(0,i.jsx)(s.code,{children:"root"})," API as an alternative that returns a root ",(0,i.jsx)(s.strong,{children:"host"})," element. The difference between ",(0,i.jsx)(s.code,{children:"root"})," and ",(0,i.jsx)(s.code,{children:"UNSAFE_root"})," properties is that that ",(0,i.jsx)(s.code,{children:"root"})," will always represents a host element, while ",(0,i.jsx)(s.code,{children:"UNSAFE_root"})," will typically represent a composite element."]}),"\n",(0,i.jsxs)(s.p,{children:["If you use ",(0,i.jsx)(s.code,{children:"toBeOnTheScreen"})," matcher from ",(0,i.jsx)(s.a,{href:"https://github.com/testing-library/jest-native",rel:"noopener noreferrer",target:"_blank",children:"@testing-library/jest-native"})," your tests will fail because it uses the ",(0,i.jsx)(s.code,{children:"container"})," api. To fix this, update ",(0,i.jsx)(s.code,{children:"@testing-library/jest-native"})," to version 5.4.2."]}),"\n",(0,i.jsxs)(s.h2,{id:"full-changelog",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#full-changelog",children:"#"}),"Full Changelog"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"https://github.com/callstack/react-native-testing-library/compare/v11.5.2...v12.0.0",rel:"noopener noreferrer",target:"_blank",children:"https://github.com/callstack/react-native-testing-library/compare/v11.5.2...v12.0.0"})})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["13.x%2Fdocs%2Fmigration%2Fprevious%2Fv12.mdx"]={toc:[{id:"breaking-changes",text:"Breaking changes",depth:2},{id:"1-all-queries-exclude-elements-hidden-from-accessibility-by-default",text:"1. All queries exclude elements hidden from accessibility by default",depth:3},{id:"2-byrole-queries-now-return-only-accessibility-elements",text:"2. `*ByRole` queries now return only accessibility elements",depth:3},{id:"examples",text:"Examples",depth:4},{id:"3-bytext-bydisplayvalue-byplaceholdertext-queries-now-return-host-elements",text:"3. `*ByText`, `*ByDisplayValue`, `*ByPlaceholderText` queries now return host elements",depth:3},{id:"4-container-api-has-been-renamed-to-unsafe_root",text:"4. `container` API has been renamed to `UNSAFE_root`.",depth:3},{id:"full-changelog",text:"Full Changelog",depth:2}],title:"Migration to 12.x",headingTitle:"Migration to 12.x",frontmatter:{}}}}]);