"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["3241"],{9546:function(e,n,r){r.r(n),r.d(n,{default:()=>c});var s=r(5893),t=r(65),d=r(5552);function i(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",strong:"strong",ul:"ul",li:"li",code:"code",div:"div",h3:"h3",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",h4:"h4",h5:"h5",pre:"pre"},(0,t.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"migration-to-14x",children:["Migration to 14.x",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#migration-to-14x",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"This guide describes the migration to React Native Testing Library version 14 from version 13.x."}),"\n",(0,s.jsxs)(n.h2,{id:"overview",children:["Overview",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#overview",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["RNTL v14 is a major release that ",(0,s.jsx)(n.strong,{children:"drops support for React 18"})," and fully embraces React 19's async-first paradigm. Key changes include:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"React 19+ required"}),": Minimum supported versions are React 19.0.0 and React Native 0.78+"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Async APIs by default"}),": ",(0,s.jsx)(n.code,{children:"render"}),", ",(0,s.jsx)(n.code,{children:"renderHook"}),", ",(0,s.jsx)(n.code,{children:"fireEvent"}),", and ",(0,s.jsx)(n.code,{children:"act"})," are now async"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"New renderer"}),": Switched from deprecated ",(0,s.jsx)(n.a,{href:"https://reactjs.org/docs/test-renderer.html",target:"_blank",rel:"noopener noreferrer",children:"React Test Renderer"})," to ",(0,s.jsx)(n.a,{href:"https://github.com/mdjastrzebski/test-renderer",target:"_blank",rel:"noopener noreferrer",children:"Test Renderer"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"API cleanup"}),": Removed deprecated APIs (",(0,s.jsx)(n.code,{children:"update"}),", ",(0,s.jsx)(n.code,{children:"getQueriesForElement"}),", ",(0,s.jsx)(n.code,{children:"UNSAFE_root"}),", ",(0,s.jsx)(n.code,{children:"concurrentRoot"})," option)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Safe ",(0,s.jsx)(n.code,{children:"container"})," API"]}),": Reintroduced ",(0,s.jsx)(n.code,{children:"container"})," which is now safe to use"]}),"\n"]}),"\n",(0,s.jsxs)(n.div,{className:"rspress-directive info",children:[(0,s.jsx)(n.div,{className:"rspress-directive-title",children:"React 18 Users"}),(0,s.jsxs)(n.div,{className:"rspress-directive-content",children:["\n",(0,s.jsx)(n.p,{children:"If you need to support React 18, please continue using RNTL v13.x."}),"\n"]})]}),"\n",(0,s.jsxs)(n.h2,{id:"quick-migration",children:["Quick Migration",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#quick-migration",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"We provide codemods to automate most of the migration:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 1: Update dependencies"})}),"\n",(0,s.jsx)(d.SU,{command:{npm:"npx codemod@latest rntl-v14-update-deps --target .\nnpm install",yarn:"yarn dlx codemod@latest rntl-v14-update-deps --target .\nyarn install",pnpm:"pnpm dlx codemod@latest rntl-v14-update-deps --target .\npnpm install",bun:"bunx codemod@latest rntl-v14-update-deps --target .\nbun install"}}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Step 2: Update test code to async"})}),"\n",(0,s.jsx)(d.SU,{command:{npm:"npx codemod@latest rntl-v14-async-functions --target ./src",yarn:"yarn dlx codemod@latest rntl-v14-async-functions --target ./src",pnpm:"pnpm dlx codemod@latest rntl-v14-async-functions --target ./src",bun:"bunx codemod@latest rntl-v14-async-functions --target ./src"}}),"\n",(0,s.jsx)(n.p,{children:"After running the codemods, review the changes and run your tests."}),"\n",(0,s.jsxs)(n.h2,{id:"breaking-changes",children:["Breaking Changes",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#breaking-changes",children:"#"})]}),"\n",(0,s.jsxs)(n.h3,{id:"supported-react-and-react-native-versions",children:["Supported React and React Native versions",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#supported-react-and-react-native-versions",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"This version requires React 19+ and React Native 0.78+."})," If you need to support React 18, please use the latest v13.x version."]}),"\n",(0,s.jsxs)(n.table,{children:["\n",(0,s.jsxs)(n.thead,{children:["\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.th,{children:"RNTL Version"}),"\n",(0,s.jsx)(n.th,{children:"React Version"}),"\n",(0,s.jsx)(n.th,{children:"React Native Version"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.tbody,{children:["\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"v14.x"}),"\n",(0,s.jsx)(n.td,{children:">= 19.0.0"}),"\n",(0,s.jsx)(n.td,{children:">= 0.78"}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"v13.x"}),"\n",(0,s.jsx)(n.td,{children:">= 18.0.0"}),"\n",(0,s.jsx)(n.td,{children:">= 0.71"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"test-renderer-replaces-react-test-renderer",children:["Test Renderer replaces React Test Renderer",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#test-renderer-replaces-react-test-renderer",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In v14, React Native Testing Library now uses ",(0,s.jsx)(n.a,{href:"https://github.com/mdjastrzebski/test-renderer",target:"_blank",rel:"noopener noreferrer",children:"Test Renderer"})," instead of the deprecated ",(0,s.jsx)(n.a,{href:"https://reactjs.org/docs/test-renderer.html",target:"_blank",rel:"noopener noreferrer",children:"React Test Renderer"}),". Test Renderer is a modern, actively maintained alternative that provides better compatibility with React 19 and improved type safety."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What changed:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The underlying renderer has been switched from React Test Renderer to Test Renderer"}),"\n",(0,s.jsx)(n.li,{children:"This change is mostly internal and should not require code changes in most cases"}),"\n",(0,s.jsxs)(n.li,{children:["Type definitions have been updated to use ",(0,s.jsx)(n.a,{href:"https://github.com/mdjastrzebski/test-renderer#hostelement",target:"_blank",rel:"noopener noreferrer",children:(0,s.jsx)(n.code,{children:"HostElement"})})," from Test Renderer instead of ",(0,s.jsx)(n.code,{children:"ReactTestInstance"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Migration:"})}),"\n",(0,s.jsxs)(n.h4,{id:"1-update-dependencies",children:["1. Update dependencies",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-update-dependencies",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Run codemod for updating dependencies:"}),"\n",(0,s.jsx)(d.SU,{command:{npm:"npx codemod@latest rntl-v14-update-deps\nnpm install",yarn:"yarn dlx codemod@latest rntl-v14-update-deps\nyarn install",pnpm:"pnpm dlx codemod@latest rntl-v14-update-deps\npnpm install",bun:"bunx codemod@latest rntl-v14-update-deps\nbun install"}}),"\n",(0,s.jsxs)(n.h5,{id:"manual-changes",children:["Manual changes",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#manual-changes",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Remove React Test Renderer and its type definitions from your dev dependencies, and add Test Renderer:"}),"\n",(0,s.jsx)(d.SU,{command:{npm:"npm uninstall react-test-renderer @types/react-test-renderer\nnpm install -D test-renderer@^0.14.0",yarn:"yarn remove react-test-renderer @types/react-test-renderer\nyarn add -D test-renderer@^0.14.0",pnpm:"pnpm remove react-test-renderer @types/react-test-renderer\npnpm add -D test-renderer@^0.14.0",bun:"bun remove react-test-renderer @types/react-test-renderer\nbun add -D test-renderer@^0.14.0"}}),"\n",(0,s.jsxs)(n.h4,{id:"2-update-type-imports-if-needed",children:["2. Update type imports (if needed)",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2-update-type-imports-if-needed",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"If you were directly importing types from React Test Renderer, you may need to update your imports:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Before (v13)\nimport type { ReactTestInstance } from 'react-test-renderer';\n\n// After (v14)\nimport type { HostElement } from 'test-renderer';\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Most users won't need to update type imports, as React Native Testing Library now exports the necessary types directly."]}),"\n",(0,s.jsxs)(n.p,{children:["For more details, see the ",(0,s.jsx)(n.a,{href:"https://github.com/mdjastrzebski/test-renderer",target:"_blank",rel:"noopener noreferrer",children:"Test Renderer documentation"}),"."]}),"\n",(0,s.jsxs)(n.h3,{id:"async-apis-by-default",children:["Async APIs by Default",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#async-apis-by-default",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"With React 18 support dropped, RNTL v14 fully embraces React 19's async rendering model. The following functions are now async by default:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"render()"})," → returns ",(0,s.jsx)(n.code,{children:"Promise<RenderResult>"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"rerender()"})," and ",(0,s.jsx)(n.code,{children:"unmount()"})," → return ",(0,s.jsx)(n.code,{children:"Promise<void>"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"renderHook()"})," → returns ",(0,s.jsx)(n.code,{children:"Promise<RenderHookResult>"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"fireEvent()"})," and helpers (",(0,s.jsx)(n.code,{children:"press"}),", ",(0,s.jsx)(n.code,{children:"changeText"}),", ",(0,s.jsx)(n.code,{children:"scroll"}),") → return ",(0,s.jsx)(n.code,{children:"Promise<void>"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"act()"})," → always returns ",(0,s.jsx)(n.code,{children:"Promise<T>"})]}),"\n"]}),"\n",(0,s.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,s.jsx)(n.div,{className:"rspress-directive-title",children:"Already using async APIs?"}),(0,s.jsxs)(n.div,{className:"rspress-directive-content",children:["\n",(0,s.jsxs)(n.p,{children:["If you adopted the async APIs introduced in RNTL v13.3 (",(0,s.jsx)(n.code,{children:"renderAsync"}),", ",(0,s.jsx)(n.code,{children:"fireEventAsync"}),", ",(0,s.jsx)(n.code,{children:"renderHookAsync"}),"), simply rename them to their non-async counterparts (",(0,s.jsx)(n.code,{children:"render"}),", ",(0,s.jsx)(n.code,{children:"fireEvent"}),", ",(0,s.jsx)(n.code,{children:"renderHook"}),"). The async versions have been removed as the standard APIs are now async by default."]}),"\n"]})]}),"\n",(0,s.jsxs)(n.h4,{id:"render-async-default",children:[(0,s.jsx)(n.code,{children:"render"})," is now async",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#render-async-default",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In v14, ",(0,s.jsx)(n.code,{children:"render"})," is now async by default and returns a Promise. This change enables proper support for async React features like ",(0,s.jsx)(n.code,{children:"Suspense"})," boundary or ",(0,s.jsx)(n.code,{children:"use()"})," hook."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before (v13):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { render, screen } from '@testing-library/react-native';\n\nit('should render component', () => {\n  render(<MyComponent />);\n  expect(screen.getByText('Hello')).toBeOnTheScreen();\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After (v14):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { render, screen } from '@testing-library/react-native';\n\nit('should render component', async () => {\n  await render(<MyComponent />);\n  expect(screen.getByText('Hello')).toBeOnTheScreen();\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For more details, see the ",(0,s.jsxs)(n.a,{href:"/docs/api/render",children:[(0,s.jsx)(n.code,{children:"render"})," API documentation"]}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"renderhook-is-now-async",children:[(0,s.jsx)(n.code,{children:"renderHook"})," is now async",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#renderhook-is-now-async",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In v14, ",(0,s.jsx)(n.code,{children:"renderHook"})," is now async by default and returns a Promise."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before (v13):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { renderHook } from '@testing-library/react-native';\n\nit('should test hook', () => {\n  const { result, rerender } = renderHook(() => useMyHook());\n\n  rerender(newProps);\n  unmount();\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After (v14):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { renderHook } from '@testing-library/react-native';\n\nit('should test hook', async () => {\n  const { result, rerender } = await renderHook(() => useMyHook());\n\n  await rerender(newProps);\n  await unmount();\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For more details, see the ",(0,s.jsxs)(n.a,{href:"/docs/api/misc/render-hook",children:[(0,s.jsx)(n.code,{children:"renderHook"})," API documentation"]}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"fireevent-is-now-async",children:[(0,s.jsx)(n.code,{children:"fireEvent"})," is now async",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#fireevent-is-now-async",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In v14, ",(0,s.jsx)(n.code,{children:"fireEvent"})," and its helpers (",(0,s.jsx)(n.code,{children:"press"}),", ",(0,s.jsx)(n.code,{children:"changeText"}),", ",(0,s.jsx)(n.code,{children:"scroll"}),") are now async by default and return a Promise."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before (v13):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { fireEvent, screen } from '@testing-library/react-native';\n\nit('should press button', () => {\n  render(<MyComponent />);\n  fireEvent.press(screen.getByText('Press me'));\n  expect(onPress).toHaveBeenCalled();\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After (v14):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { fireEvent, screen } from '@testing-library/react-native';\n\nit('should press button', async () => {\n  await render(<MyComponent />);\n  await fireEvent.press(screen.getByText('Press me'));\n  expect(onPress).toHaveBeenCalled();\n});\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"act-is-now-async",children:[(0,s.jsx)(n.code,{children:"act"})," is now async",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#act-is-now-async",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In v14, ",(0,s.jsx)(n.code,{children:"act"})," is now async by default and always returns a Promise. You should always ",(0,s.jsx)(n.code,{children:"await"})," the result of ",(0,s.jsx)(n.code,{children:"act()"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What changed:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"act"})," now always returns a ",(0,s.jsx)(n.code,{children:"Promise<T>"})," instead of ",(0,s.jsx)(n.code,{children:"T | Thenable<T>"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"act"})," should always be awaited"]}),"\n",(0,s.jsx)(n.li,{children:"The API is more consistent and predictable"}),"\n"]}),"\n",(0,s.jsxs)(n.div,{className:"rspress-directive note",children:[(0,s.jsx)(n.div,{className:"rspress-directive-title",children:"NOTE"}),(0,s.jsxs)(n.div,{className:"rspress-directive-content",children:["\n",(0,s.jsxs)(n.p,{children:["The transition to async ",(0,s.jsx)(n.code,{children:"act"})," may prevent testing very short transient states, as awaiting ",(0,s.jsx)(n.code,{children:"act"})," will flush all pending updates before returning."]}),"\n"]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before (v13):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { act } from '@testing-library/react-native';\n\nit('should update state', () => {\n  act(() => {\n    setState('new value');\n  });\n  expect(state).toBe('new value');\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After (v14):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { act } from '@testing-library/react-native';\n\nit('should update state', async () => {\n  await act(() => {\n    setState('new value');\n  });\n  expect(state).toBe('new value');\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),": Even if your callback is synchronous, you should still use ",(0,s.jsx)(n.code,{children:"await act(...)"})," as ",(0,s.jsx)(n.code,{children:"act"})," now always returns a Promise."]}),"\n",(0,s.jsxs)(n.p,{children:["For more details, see the ",(0,s.jsxs)(n.a,{href:"/docs/api/misc/other#act",children:[(0,s.jsx)(n.code,{children:"act"})," API documentation"]}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"benefits-of-async-apis",children:["Benefits of Async APIs",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#benefits-of-async-apis",children:"#"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Suspense support"}),": Properly handles ",(0,s.jsx)(n.code,{children:"Suspense"})," boundaries and ",(0,s.jsx)(n.code,{children:"use()"})," hook"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Better timing"}),": Ensures all pending React updates are executed before assertions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Simpler mental model"}),": All rendering operations are consistently async"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Future-proof"}),": Aligns with React's direction toward async rendering"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"removed-apis",children:["Removed APIs",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#removed-apis",children:"#"})]}),"\n",(0,s.jsxs)(n.h4,{id:"update-alias-removed",children:[(0,s.jsx)(n.code,{children:"update"})," alias removed",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#update-alias-removed",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"update"})," alias for ",(0,s.jsx)(n.code,{children:"rerender"})," has been removed. Use ",(0,s.jsx)(n.code,{children:"rerender"})," instead:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Before (v13)\nscreen.update(<MyComponent />);\nconst { update } = render(<MyComponent />);\nupdate(<MyComponent newProp />);\n\n// After (v14)\nawait screen.rerender(<MyComponent />);\nconst { rerender } = await render(<MyComponent />);\nawait rerender(<MyComponent newProp />);\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"getqueriesforelement-export-removed",children:[(0,s.jsx)(n.code,{children:"getQueriesForElement"})," export removed",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#getqueriesforelement-export-removed",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"getQueriesForElement"})," export alias for ",(0,s.jsx)(n.code,{children:"within"})," has been removed. Use ",(0,s.jsx)(n.code,{children:"within"})," instead:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Before (v13)\nimport { getQueriesForElement } from '@testing-library/react-native';\n\nconst queries = getQueriesForElement(element);\n\n// After (v14)\nimport { within } from '@testing-library/react-native';\n\nconst queries = within(element);\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," ",(0,s.jsx)(n.code,{children:"getQueriesForElement"})," was just an alias for ",(0,s.jsx)(n.code,{children:"within"}),", so the functionality is identical - only the import needs to change."]}),"\n",(0,s.jsxs)(n.h4,{id:"unsafe_root-removed",children:[(0,s.jsx)(n.code,{children:"UNSAFE_root"})," removed",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#unsafe_root-removed",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"UNSAFE_root"})," has been removed. Use ",(0,s.jsx)(n.code,{children:"container"})," to access the pseudo-element container, or ",(0,s.jsx)(n.code,{children:"root"})," to access the first rendered host element:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Before (v13)\nconst unsafeRoot = screen.UNSAFE_root;\n\n// After (v14)\nconst container = screen.container; // pseudo-element container\nconst root = screen.root; // first rendered host element\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"legacy-unsafe_-queries-removed",children:["Legacy ",(0,s.jsx)(n.code,{children:"UNSAFE_*"})," queries removed",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#legacy-unsafe_-queries-removed",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["The legacy ",(0,s.jsx)(n.code,{children:"UNSAFE_getAllByType"}),", ",(0,s.jsx)(n.code,{children:"UNSAFE_getByType"}),", ",(0,s.jsx)(n.code,{children:"UNSAFE_getAllByProps"}),", and ",(0,s.jsx)(n.code,{children:"UNSAFE_getByProps"})," queries have been removed. These queries could return composite (user-defined) components, which is no longer supported with ",(0,s.jsx)(n.a,{href:"https://github.com/mdjastrzebski/test-renderer",target:"_blank",rel:"noopener noreferrer",children:"Test Renderer"})," as it only renders host elements."]}),"\n",(0,s.jsxs)(n.p,{children:["If you were using these legacy queries, you should refactor your tests to use the standard queries (",(0,s.jsx)(n.code,{children:"getByRole"}),", ",(0,s.jsx)(n.code,{children:"getByText"}),", ",(0,s.jsx)(n.code,{children:"getByTestId"}),", etc.) which target host elements."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Before (v13)\nconst buttons = screen.UNSAFE_getAllByType(Button);\nconst input = screen.UNSAFE_getByProps({ placeholder: 'Enter text' });\n\n// After (v14)\nconst buttons = screen.getAllByRole('button');\nconst input = screen.getByPlaceholderText('Enter text');\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"concurrentroot-option-removed",children:[(0,s.jsx)(n.code,{children:"concurrentRoot"})," option removed",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#concurrentroot-option-removed",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"concurrentRoot"})," option has been removed from both ",(0,s.jsx)(n.code,{children:"render"})," options and ",(0,s.jsx)(n.code,{children:"configure"})," function. In v14, concurrent rendering is always enabled by default, as it is the standard rendering mode for React 19 and React Native's New Architecture."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Before (v13)\nrender(<MyComponent />, { concurrentRoot: true });  // Enable concurrent mode\nrender(<MyComponent />, { concurrentRoot: false }); // Disable concurrent mode\nconfigure({ concurrentRoot: false });               // Disable globally\n\n// After (v14)\nawait render(<MyComponent />); // Always uses concurrent rendering\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Migration:"})," Simply remove any ",(0,s.jsx)(n.code,{children:"concurrentRoot"})," options from your ",(0,s.jsx)(n.code,{children:"render"})," calls and ",(0,s.jsx)(n.code,{children:"configure"})," function. If you were explicitly setting ",(0,s.jsx)(n.code,{children:"concurrentRoot: true"}),", no changes are needed beyond removing the option. If you were setting ",(0,s.jsx)(n.code,{children:"concurrentRoot: false"})," to disable concurrent rendering, this is no longer supported in v14."]}),"\n",(0,s.jsxs)(n.h3,{id:"container-api-reintroduced",children:[(0,s.jsx)(n.code,{children:"container"})," API reintroduced",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#container-api-reintroduced",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In v14, the ",(0,s.jsx)(n.code,{children:"container"})," API has been reintroduced and is now safe to use. Previously, ",(0,s.jsx)(n.code,{children:"container"})," was renamed to ",(0,s.jsx)(n.code,{children:"UNSAFE_root"})," in v12 due to behavioral differences from React Testing Library's ",(0,s.jsx)(n.code,{children:"container"}),". In v14, ",(0,s.jsx)(n.code,{children:"container"})," now returns a pseudo-element container whose children are the elements you asked to render, making it safe and consistent with React Testing Library's behavior."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What changed:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"screen.container"})," is now available and safe to use"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"container"})," returns a pseudo-element container from Test Renderer"]}),"\n",(0,s.jsx)(n.li,{children:"The container's children are the elements you rendered"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"UNSAFE_root"})," has been removed"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before (v13):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { render, screen } from '@testing-library/react-native';\n\nit('should access root', () => {\n  render(<MyComponent />);\n  // UNSAFE_root was the only way to access the container\n  const root = screen.UNSAFE_root;\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After (v14):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { render, screen } from '@testing-library/react-native';\n\nit('should access container', async () => {\n  await render(<MyComponent />);\n  // container is now safe and available\n  const container = screen.container;\n  // root is the first child of container\n  const root = screen.root;\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For more details, see the ",(0,s.jsxs)(n.a,{href:"/docs/api/screen#container",children:[(0,s.jsx)(n.code,{children:"screen"})," API documentation"]}),"."]}),"\n",(0,s.jsxs)(n.h3,{id:"text-string-validation-enforced-by-default",children:["Text string validation enforced by default",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#text-string-validation-enforced-by-default",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["In v14, Test Renderer automatically enforces React Native's requirement that text strings must be rendered within a ",(0,s.jsx)(n.code,{children:"<Text>"})," component. This means the ",(0,s.jsx)(n.code,{children:"unstable_validateStringsRenderedWithinText"})," option has been removed from ",(0,s.jsx)(n.code,{children:"RenderOptions"}),", as this validation is now always enabled."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What changed:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Text string validation is now always enabled and cannot be disabled"}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"unstable_validateStringsRenderedWithinText"})," option has been removed"]}),"\n",(0,s.jsxs)(n.li,{children:["Tests will now throw ",(0,s.jsx)(n.code,{children:"Invariant Violation: Text strings must be rendered within a <Text> component"})," errors when attempting to render strings outside of ",(0,s.jsx)(n.code,{children:"<Text>"})," components, matching React Native's runtime behavior"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Migration:"})}),"\n",(0,s.jsxs)(n.p,{children:["If you were using ",(0,s.jsx)(n.code,{children:"unstable_validateStringsRenderedWithinText: true"})," in your render options, you can simply remove this option as the validation is now always enabled:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Before (v13)\nrender(<MyComponent />, {\n  unstable_validateStringsRenderedWithinText: true,\n});\n\n// After (v14)\nawait render(<MyComponent />);\n// Validation is now always enabled\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you were relying on the previous behavior where strings could be rendered outside of ",(0,s.jsx)(n.code,{children:"<Text>"})," components, you'll need to fix your components to wrap strings in ",(0,s.jsx)(n.code,{children:"<Text>"})," components, as this matches React Native's actual runtime behavior."]}),"\n",(0,s.jsxs)(n.h2,{id:"codemods",children:["Codemods",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#codemods",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["We provide two codemods to automate the migration. Both codemods are ",(0,s.jsx)(n.strong,{children:"safe to run multiple times"})," - they will only transform code that hasn't been migrated yet."]}),"\n",(0,s.jsxs)(n.h3,{id:"rntl-v14-update-deps",children:[(0,s.jsx)(n.code,{children:"rntl-v14-update-deps"}),(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rntl-v14-update-deps",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Updates your ",(0,s.jsx)(n.code,{children:"package.json"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Removes React Test Renderer (",(0,s.jsx)(n.code,{children:"react-test-renderer"})," and ",(0,s.jsx)(n.code,{children:"@types/react-test-renderer"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Adds Test Renderer (",(0,s.jsx)(n.code,{children:"test-renderer"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Updates ",(0,s.jsx)(n.code,{children:"@testing-library/react-native"})," to ",(0,s.jsx)(n.code,{children:"^14.0.0"})]}),"\n"]}),"\n",(0,s.jsx)(d.SU,{command:{npm:"npx codemod@latest rntl-v14-update-deps --target .\nnpm install",yarn:"yarn dlx codemod@latest rntl-v14-update-deps --target .\nyarn install",pnpm:"pnpm dlx codemod@latest rntl-v14-update-deps --target .\npnpm install",bun:"bunx codemod@latest rntl-v14-update-deps --target .\nbun install"}}),"\n",(0,s.jsxs)(n.h3,{id:"rntl-v14-async-functions",children:[(0,s.jsx)(n.code,{children:"rntl-v14-async-functions"}),(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rntl-v14-async-functions",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"Transforms test files:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Adds ",(0,s.jsx)(n.code,{children:"await"})," to ",(0,s.jsx)(n.code,{children:"render()"}),", ",(0,s.jsx)(n.code,{children:"act()"}),", ",(0,s.jsx)(n.code,{children:"renderHook()"}),", ",(0,s.jsx)(n.code,{children:"fireEvent()"})," calls"]}),"\n",(0,s.jsx)(n.li,{children:"Makes test functions async when needed"}),"\n",(0,s.jsxs)(n.li,{children:["Handles ",(0,s.jsx)(n.code,{children:"screen.rerender()"}),", ",(0,s.jsx)(n.code,{children:"screen.unmount()"}),", and renderer methods"]}),"\n"]}),"\n",(0,s.jsx)(d.SU,{command:{npm:"npx codemod@latest rntl-v14-async-functions --target ./src",yarn:"yarn dlx codemod@latest rntl-v14-async-functions --target ./src",pnpm:"pnpm dlx codemod@latest rntl-v14-async-functions --target ./src",bun:"bunx codemod@latest rntl-v14-async-functions --target ./src"}}),"\n",(0,s.jsxs)(n.h4,{id:"custom-render-functions",children:["Custom render functions",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#custom-render-functions",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["If you have custom render helpers (like ",(0,s.jsx)(n.code,{children:"renderWithProviders"}),"), you can specify them using the ",(0,s.jsx)(n.code,{children:"customRenderFunctions"})," parameter. The codemod will then also transform calls to these functions:"]}),"\n",(0,s.jsx)(d.SU,{command:{npm:'npx codemod@latest rntl-v14-async-functions \\\n  --target ./src \\\n  --param customRenderFunctions="renderWithProviders,renderWithTheme"',yarn:'yarn dlx codemod@latest rntl-v14-async-functions \\\n  --target ./src \\\n  --param customRenderFunctions="renderWithProviders,renderWithTheme"',pnpm:'pnpm dlx codemod@latest rntl-v14-async-functions \\\n  --target ./src \\\n  --param customRenderFunctions="renderWithProviders,renderWithTheme"',bun:'bunx codemod@latest rntl-v14-async-functions \\\n  --target ./src \\\n  --param customRenderFunctions="renderWithProviders,renderWithTheme"'}}),"\n",(0,s.jsxs)(n.p,{children:["This will add ",(0,s.jsx)(n.code,{children:"await"})," to your custom render calls and make the containing test functions async, just like it does for the standard ",(0,s.jsx)(n.code,{children:"render"})," function."]}),"\n",(0,s.jsxs)(n.h4,{id:"limitations",children:["Limitations",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#limitations",children:"#"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Helper functions defined in test files are not transformed by default"}),"\n",(0,s.jsxs)(n.li,{children:["Namespace imports (",(0,s.jsx)(n.code,{children:"import * as RNTL"}),") are not handled"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"full-changelog",children:["Full Changelog",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#full-changelog",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/compare/v13.3.3...v14.0.0",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/callstack/react-native-testing-library/compare/v13.3.3...v14.0.0"})})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,t.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(i,{...e})}):i(e)}let c=a;a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["14.x%2Fdocs%2Fmigration%2Fv14.mdx"]={toc:[{text:"Overview",id:"overview",depth:2},{text:"Quick Migration",id:"quick-migration",depth:2},{text:"Breaking Changes",id:"breaking-changes",depth:2},{text:"Supported React and React Native versions",id:"supported-react-and-react-native-versions",depth:3},{text:"Test Renderer replaces React Test Renderer",id:"test-renderer-replaces-react-test-renderer",depth:3},{text:"1. Update dependencies",id:"1-update-dependencies",depth:4},{text:"2. Update type imports (if needed)",id:"2-update-type-imports-if-needed",depth:4},{text:"Async APIs by Default",id:"async-apis-by-default",depth:3},{text:"`render` is now async",id:"render-async-default",depth:4},{text:"`renderHook` is now async",id:"renderhook-is-now-async",depth:4},{text:"`fireEvent` is now async",id:"fireevent-is-now-async",depth:4},{text:"`act` is now async",id:"act-is-now-async",depth:4},{text:"Benefits of Async APIs",id:"benefits-of-async-apis",depth:4},{text:"Removed APIs",id:"removed-apis",depth:3},{text:"`update` alias removed",id:"update-alias-removed",depth:4},{text:"`getQueriesForElement` export removed",id:"getqueriesforelement-export-removed",depth:4},{text:"`UNSAFE_root` removed",id:"unsafe_root-removed",depth:4},{text:"Legacy `UNSAFE_*` queries removed",id:"legacy-unsafe_-queries-removed",depth:4},{text:"`concurrentRoot` option removed",id:"concurrentroot-option-removed",depth:4},{text:"`container` API reintroduced",id:"container-api-reintroduced",depth:3},{text:"Text string validation enforced by default",id:"text-string-validation-enforced-by-default",depth:3},{text:"Codemods",id:"codemods",depth:2},{text:"`rntl-v14-update-deps`",id:"rntl-v14-update-deps",depth:3},{text:"`rntl-v14-async-functions`",id:"rntl-v14-async-functions",depth:3},{text:"Custom render functions",id:"custom-render-functions",depth:4},{text:"Limitations",id:"limitations",depth:4},{text:"Full Changelog",id:"full-changelog",depth:2}],title:"Migration to 14.x",headingTitle:"Migration to 14.x",frontmatter:{}}}}]);